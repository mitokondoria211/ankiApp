<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>デッキ編集</title>
</head>
<body>
    <div th:insert="~{common/sourceList :: sourceList}"></div>
    
    <div th:replace="~{common/messageIcon :: messageIcon}"></div>
    <div th:replace="~{common/menuHeader :: menuHeader}"></div>
    <div class = "container-fluid mx-auto text-center w-75">
        <h1 class="text-center mt-5 pt-3 h2">カード更新</h1>
        <div th:replace="~{common/header :: header}"></div>
        <div class="alert  d-flex align-items-center mx-auto col-5" 
        th:classappend="${isError ? 'alert-danger' : 'alert-primary'}" role="alert" 
                th:if="${message != null}" >
            <div class="d-flex align-items-center justify-content-center text-center">
                <svg class="bi flex-shrink-0 me-2" width="24" height="24">
                    <use xlink:href="#exclamation-triangle-fill" th:if="${isError}"/>
                    <use xlink:href="#info-fill" th:unless="${isError}"/>
                </svg>
                <span th:utext="${message}"></span>
            </div>
        </div>
        <h2 th:text="'カード：' + ${updateCard.cardName} + ' の更新'" class="mx-auto h3 my-4 col-6"></h2>
        <form th:action="@{/updateCard}" method="post" enctype="multipart/form-data" th:object="${cardUpdateForm}">
            <input type="hidden" th:field="*{cardId}" />
            <div class="mt-3 " th:each="card: ${updateCard}">
                <div class="mx-auto col-6 text-start my-5">
                    <h3 class="text-center h4">カード名</h3>
                    <label class="form-label fw-bold d-flex">
                        <span class="flex-shrink-0">変更前：</span>
                        <span th:text="${card.cardName}" class="fw-normal"></span>     
                    </label>
                    <input type="text"class="form-control" th:field="*{cardName}">
                    <div class="text-danger" th:if="${#fields.hasErrors('cardName')}" 
                              th:errors="*{cardName}"></div>

                </div>
                <div class="mx-auto col-6 text-start my-5">
                    <h3 class="text-center h4">問題</h3>
                    <label  class="form-label fw-bold d-flex">
                        <span class="flex-shrink-0">変更前： </span>
                        <span th:text="${card.question}" class="fw-normal text-break" style="white-space: pre-wrap;"></span>
                    </label>
                    <textarea class="form-control" th:field="*{question}" style="white-space: pre-wrap;"></textarea>
                    <div class="text-danger" th:if="${#fields.hasErrors('question')}" 
                              th:errors="*{question}"></div>
                </div>
                
                <div class="my-5">
                        <div>
                            <h3 class="text-center h4 mb-3">問題画像</h3>
                            <label  class="form-label fw-bold">変更前</label>
                            
                            <div th:if="${cardUpdateForm.questionImagePath == 'default.jpg'}" 
                                    class="my-4">
                                画像なし
                            </div>
                            <div th:unless="${cardUpdateForm.questionImagePath == 'default.jpg'}">
                                <img th:src="${questionImage}" 
                                          alt="Deck Image" 
                                          class="mx-auto mb-4 col-6"/>
                            </div>
                            
                        </div>
                        <input type="hidden" th:field="*{questionImagePath}">
                        <input type="file" th:field="*{questionImageFile}">
                </div>
                
                <div class="mx-auto col-6 text-start my-5">
                    <h3 class="text-center h4">解答</h3>
                    <label  class="form-label fw-bold d-flex">
                        <span class="flex-shrink-0">変更前： </span>
                        <span th:text="${card.answer}" class="fw-normal text-break" style="white-space: pre-wrap;"></span>
                    </label>
                    <textarea class="form-control" th:field="*{answer}"  style="white-space: pre-wrap;"></textarea>
                    <div class="text-danger" th:if="${#fields.hasErrors('answer')}" 
                              th:errors="*{answer}"></div>
                </div>
                
<!--                <div class="mx-auto col-5 text-start mt-3 mb-3">-->
<!--                    <label th:text="'変更前解答:  ' + ${card.answer}" class="form-label"></label>-->
<!--                    <textarea class="form-control" th:field="*{answer}"></textarea>-->
<!--                    <div class="text-danger" th:if="${#fields.hasErrors('answer')}" -->
<!--                              th:errors="*{answer}"></div>-->
<!--                </div>-->
                <div class="my-5">
                        <div>
                            <h3 class="text-center h4 mb-3">解答画像</h3>
                            <label  class="form-label fw-bold">変更前</label>
                            
                            <div th:if="${cardUpdateForm.answerImagePath == 'default.jpg'}" 
                                    class="my-4">
                                画像なし
                            </div>
                            <div th:unless="${cardUpdateForm.answerImagePath == 'default.jpg'}">
                                <img th:src="${answerImage}" 
                                          alt="Deck Image" 
                                          class="mx-auto mb-4 col-6"/>
                            </div>
                            
                        </div>
                        <input type="hidden" th:field="*{answerImagePath}">
                        <input type="file" th:field="*{answerImageFile}">
                </div>
<!--                <div class="mt-4 mb-4">-->
<!--                    <div>-->
<!--                        <p><label class="fw-bold">解答画像:</label><br>-->
<!--                        <img th:src="${answerImage}" alt="Deck Image"-->
<!--                        class="mx-auto mb-4"/>-->
<!--                    </div>-->
<!--                    <input type="hidden" th:field="*{answerImagePath}">-->
<!--                    <input type="file" th:field="*{answerImageFile}">-->
<!--                </div>-->
                <div class="mx-auto col-6 text-start my-5">
                    <h3 class="text-center h4">カード評価</h3>
                    <label  class="form-label fw-bold">
                        変更前： <span th:text="${card.cardResult.rating}" class="fw-normal"></span>
                    </label>
                    <select th:field="*{cardResult}" class="form-select" id="cardResult"/>
                        <option th:each="cardResult : ${cardResults}"
                        th:value="${cardResult}"
                        th:text="${cardResult.rating}"
                        th:selected="${cardResult.equals(card.cardResult)}">
                        </option>
                    </select>
                </div>
<!--                <div class="mx-auto col-5 text-start mt-3 mb-3">-->
<!--                    <label th:text="'変更前カード評価:  ' + ${card.cardResult.rating}" class="form-label"></label>-->
<!--                    <select th:field="*{cardResult}" class="form-select" id="cardResult"/>-->
<!--                        <option th:each="cardResult : ${cardResults}"-->
<!--                        th:value="${cardResult}"-->
<!--                        th:text="${cardResult.rating}"-->
<!--                        th:selected="${cardResult.equals(card.cardResult)}">-->
<!--                        </option>-->
<!--                    </select>-->
<!--                </div>-->
                <div class="mb-4">
                    <input type="submit" class="btn btn-success" value="更新">
                </div>
            </div>
        </form>
        
    
    
</body>
</html>